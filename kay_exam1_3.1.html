<!DOCTYPE html>
<html>
	<head>
		<link type="text/css" rel="stylesheet" href="exam1.css"/>
		<title>Andy IE59000 - Exam1 - Question 3.1</title>

<!-- d3.js, Jquery and Ajax Scripts -->

		<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
		<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>


	</head>
	<body>

		<!-- Page Title Bar -->
		<center>
		<svg width="400" height="80">
			<rect width="400" height="70" rx="20" ry="20" style="fill:#848482"></rect>
			<rect x="5" y="5" rx="20" ry="20" width="390" height="60" style="fill:white; stroke:black; stroke-width:2"></rect>
			<text x="50" y="35" font-family="Ubuntu, Sans-Serif" font-size="20" fill="black">IE59000 Homework 3 - Andy Kay</text>
			<text x="105" y="55" font-family="Ubuntu, Sans-Serif" font-size="20" fill="black">Exam 1 Question 3.1</text>
		</svg>
		</center><br>

		<!-- Homework Title Bar -->
		<center><svg width="410" height="100">
			<rect width="390" height="70" x="5" y="5" style="fill:lightgrey; stroke:white; stroke-width:2"></rect>
			<text x="8" y="32" font-family="Ubuntu, Sans-Serif" font-size="20" fill="black"> Numbers of Senior IE Students</text>
			<text x="80" y="60" font-family="Ubuntu, Sans-Serif" font-size="15" fill="black">Mouse over for country specifics</text>
		</svg></center>

		<!-- Div for Chart -->
		<center><div class="chart">
		</div></center> 

		<br>

		<a href="https://hivelab.org/static/exam1.json" target="_blank"><p align="right">Hive Lab JSON file</p></a>

		<!-- D3.js Chart Script -->
		<script type="text/javascript">

			// read in json data using d3.js
			// Source1: is Interactive Data Visulization - Scott Murray
			// Source2: http://bl.ocks.org/mbostock/3886208
			// Source3: http://codepen.io/superpikar/pen/xCeiu
			var globalinputdata;
			var w = 600;
			var h = 600;
			var padding = 1;

				//Var for svg chart build
				var svg = d3.select("div")
					.append("svg")
					.attr("width",w)
					.attr("height", h);

			d3.json("https://hivelab.org/static/exam1.json", function(data) {
				console.log(data);

				// can properly resolve a forEach loop so going brute force method.
				globalinputdata = [[data[0][ 'University A' ], data[1][ 'University A' ], data[2][ 'University A' ], data[3][ 'University A' ]], [data[0][ 'University B' ], data[1][ 'University B' ], data[2][ 'University B' ], data[3][ 'University B' ]], [data[0][ 'University C' ], data[1][ 'University C' ], data[2][ 'University C' ], data[3][ 'University C' ]], [data[0][ 'University D' ], data[1][ 'University D' ], data[2][ 'University D' ], data[3][ 'University D' ]], [data[0][ 'University E' ], data[1][ 'University E' ], data[2][ 'University E' ], data[3][ 'University E' ]]];
 				console.log(globalinputdata);

 				// next step for a brute force method to manipulate object arrays.
 				var justseniordata = [globalinputdata[0][3], globalinputdata[1][3], globalinputdata[2][3], globalinputdata[3][3], globalinputdata[4][3]];
 				console.log(justseniordata);

				// Define scales
				var xscale =d3.scale.ordinal()
					.domain(d3.range(justseniordata.length))
					.rangeRoundBands([0,w], 0.5);
				var yscale = d3.scale.linear()
					.domain([0, d3.max(justseniordata)])
					.range([0,h]);

				// Append Circle with mouseover
				svg.selectAll("rect")
					.data(justseniordata)
					.enter()
					.append("rect")
					.attr("x", function(d, i) {
						return xscale(i);
					})
					.attr("y", function(d) {
						return h-yscale(d);
					})
					.attr("width", xscale.rangeBand())
					.attr("height", function(d) {
			   			return yscale(d);
			   		})
			   		.attr("fill", "red");

				//Define X axis
				var xAxis = d3.svg.axis()
					.scale(xscale)
					.orient("bottom")
					.ticks(9);
					//	.tickValues([100,120,140,160,180,200,220,240,250]);
					//	.tickFormat(formatPercent);

				//Define Y Axis
				var yAxis = d3.svg.axis()
					.scale(yscale)
					.orient("left")
					.ticks(6);
					//	.tickFormat(formatPercent);


			});

/*
			// d3.js read-in of cleaned/edited csv
			d3.csv("Avg4thGradeScoresClean.csv", function(gradedata) {
				// Log data for inspection
				console.log(gradedata);
			
				var w = 800;
				var h = 800;
				//var formatPercent = d3.format(".1%")
				var padding = 40;

				//Var for svg chart build
				var svg = d3.select("div")
					.append("svg")
					.attr("width",w)
					.attr("height", h);

				var xscale = d3.scale.linear()
					.domain([d3.min(gradedata, function(d){
						return d["Science instructional time hours per year"];}), d3.max(gradedata, function(d){
						return d["Mathmatics instructional time hours per year"];})
					])
					.range([padding, w - padding*2]);

				var yscale = d3.scale.linear()
					.domain([d3.min(gradedata, function(d){
						return d["Science average score\\2\\"];}), d3.max(gradedata, function(d){
						return d["Mathematics average score\\2\\"];})
					])
					.range([h - padding, padding]);

				//Define X axis
				var xAxis = d3.svg.axis()
					.scale(xscale)
					.orient("bottom")
					.ticks(9);
				//	.tickValues([100,120,140,160,180,200,220,240,250]);
				//	.tickFormat(formatPercent);

				//Define Y Axis
				var yAxis = d3.svg.axis()
					.scale(yscale)
					.orient("left")
					.ticks(6);
				//	.tickFormat(formatPercent);

				// Append Circle with mouseover
				svg.selectAll("circle")
					.data(gradedata)
					.enter()
					.append("circle")
					.attr("cx", function(d) {
						return xscale(d["Mathmatics instructional time hours per year"]);
					})
					.attr("cy", function(d) {
						return yscale(d["Mathematics average score\\2\\"]);
					})
					.attr("r", function(d) {
						return (15./1200.)*d["Total instructional hours per year"];
					})
					.attr("fill", "red")
					.on("mouseover", function (d) {
						console.log(d)
			   			svg.append("text")
			   			.attr("id","tooltip")
			   			.text(d["Country or other education system"]+":  "+d["Mathmatics instructional time hours per year"]+" hrs/yr of Math out of "+d["Total instructional hours per year"]+" total teaching hrs/yr.")//			   			.attr("x", xscale(d["Mathmatics instructional time hours per year"]))
//			   			.attr("y", yscale(d["Mathematics average score\\2\\"]))
			   			.attr("x", 0)
			   			.attr("y", 20)
			   			.attr("font-family", "ubuntu")
			   			.attr("font-size", "20px")
			   			.attr("fill", "black");
			   		})
			   		.on("mouseout", function(d) {
					//Remove the tooltip
						d3.select("#tooltip").remove();
			   		});

				// Append Ellipse with mouseover
				svg.selectAll("ellipse")
					.data(gradedata)
					.enter()
					.append("ellipse")
					.attr("cx", function(d) {
						return xscale(d["Science instructional time hours per year"])
					})
					.attr("cy", function(d) {
						return yscale(d["Science average score\\2\\"]);
					})
					.attr("rx", function(d) {
						return (15./1200.)*d["Total instructional hours per year"];
					})
					.attr("ry", function(d) {
						return (15./1200.)*d["Total instructional hours per year"];
					})
					.attr("fill", function(d) {
						if (d["Science instructional time hours per year"]=="") {return "none"}
						else { return "blue"}
					})

					.on("mouseover", function (d) {
						console.log(d)
			   			svg.append("text")
			   			.attr("id","tooltip")
			   			.text(d["Country or other education system"]+":  "+d["Science instructional time hours per year"]+" hrs/yr of Science out of "+d["Total instructional hours per year"]+" total teaching hrs/yr.")
			   			.attr("x", 0)
			   			.attr("y", 20)
			   			.attr("font-family", "ubuntu")
			   			.attr("font-size", "20px")
			   			.attr("fill", "black");
 					})
 					.on("mouseout", function(d) {
					//Remove the tooltip
						d3.select("#tooltip").remove();
			   		});

*/			   		
// Commented part to show text next to every data point. Total mess to view.
/*				svg.selectAll("text")
			   		.data(gradedata)
			   		.enter()
			   		.append("text")
			   		.text(function(d) {
						return d["Country or other education system"];
					})
			   		.attr("x", function(d) {
						return xscale(d["Mathmatics instructional time hours per year"]);			 
					})
			   		.attr("y", function(d) {
						return yscale(d["Mathematics average score\\2\\"]);
					})
			   		.attr("font-family", "ubuntu")
			   		.attr("font-size", "10px")
			   		.attr("fill", "black");
*/

/*			   		.on("mouseout", function(d) {
				   		d3.select(this)
							.attr("fill", "rgb(0, 0, " + (d * 10) + ")");
			   		});
*/
/*
			   	// Create X Axis Group
			   	svg.append("g")
			   		.attr("class","axis")
			   		.attr("transform", "translate(0, "+(h-padding)+")")
			   		.call(xAxis);

			   	// Create Y Axis group
			   	svg.append("g")
			   		.attr("class", "axis")
					.attr("transform", "translate("+padding+",0)")
			   		.call(yAxis);

			   	// Append labels,scales, etc to chart
			   	svg.append("text")
			   		.attr("class","label")
			   		.attr("text-anchor","middle")
			   		.attr("x", w/2)
			   		.attr("y", h)
			   		.text("Total Instructional Time (Hours/Year)");

			   	svg.append("text")
			   		.attr("class","label")
			   		.attr("text-anchor","end")
			   		.attr("y", padding/4)
			   		.attr("dy", ".25em")
			   		.attr("x", 0-(h/2))
			   		.attr("transform", "rotate (-90)")
			   		.text("Average Test Score");

			   	svg.append("rect")
			   		.attr("class","label")
			   		.attr("x", xscale(220))
			   		.attr("y", yscale(260))
			   		.attr("width", 20)
			   		.attr("height", 10)
			   		.attr("fill", "red");

			   	svg.append("rect")
			   		.attr("class","label")
			   		.attr("x", xscale(220))
			   		.attr("y", yscale(250))
			   		.attr("width", 20)
			   		.attr("height", 10)
			   		.attr("fill", "blue");	

			   	svg.append("text")
			   		.attr("class","label")
			   		.attr("text-anchor","left")
			   		.attr("x", xscale(230))
			   		.attr("y", yscale(255))
			   		.text("Mathmatics");

			   	svg.append("text")
			   		.attr("class","label")
			   		.attr("text-anchor","left")
			   		.attr("x", xscale(230))
			   		.attr("y", yscale(243))
			   		.text("Science");

			   	svg.append("text")
			   		.attr("class","label")
			   		.attr("text-anchor","left")
			   		.attr("x", xscale(210))
			   		.attr("y", yscale(230))
			   		.attr("font-family", "ubuntu")
			   		.attr("font-size", "9px")
			   		.text("Circles to scale in total instructional hrs/yr.")
			});
*/
		</script>

	</body></center>
</html>